<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–î–Ω–µ–≤–Ω–∏–∫ —á—É–≤—Å—Ç–≤ –∏ –º—ã—Å–ª–µ–π</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        background: linear-gradient(to bottom right, #1e293b, #0f172a);
        color: #f1f5f9;
      }
      .fade-in {
        animation: fadeIn 0.3s ease-in-out;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-5px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>
  <body class="p-4 sm:p-6 min-h-screen">
    <div class="max-w-xl mx-auto space-y-6">
      <div class="bg-slate-800 bg-opacity-80 p-4 rounded-xl shadow-md">
        <h1 class="text-xl font-semibold mb-2">üìò –ó–∞—á–µ–º –≤–µ—Å—Ç–∏ –¥–Ω–µ–≤–Ω–∏–∫?</h1>
        <p class="text-sm text-slate-300">
          –≠—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å–∞–º–æ—Ä–µ—Ñ–ª–µ–∫—Å–∏–∏. –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç–º–µ—á–∞—Ç—å, —á—Ç–æ —Å
          –≤–∞–º–∏ –ø—Ä–æ–∏–∑–æ—à–ª–æ, –∫–∞–∫–∏–µ –±—ã–ª–∏ –º—ã—Å–ª–∏ –∏ —á—É–≤—Å—Ç–≤–∞, –∏ –∫–∞–∫–∏–µ –≤—ã–≤–æ–¥—ã –≤—ã —Å–¥–µ–ª–∞–ª–∏.
          –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –∑–∞–º–µ—á–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∞–∫—Ü–∏–∏, —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å
          —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –∑–∞–±–æ—Ç–∏—Ç—å—Å—è –æ —Å–µ–±–µ.
        </p>
        <p class="text-sm text-slate-300 mt-2">
          –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏ –Ω–∞–∂–º–∏—Ç–µ ¬´–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ¬ª –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –µ–≥–æ
          –≤ Telegram-–±–æ—Ç–µ Leo –≤–æ –≤–∫–ª–∞–¥–∫–µ
          <span class="inline-flex items-center gap-1"
            ><img
              src="https://telegram.org/img/t_logo.svg"
              class="w-4 h-4 inline-block"
            />
            –ò–ò-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç</span
          >. –û–Ω –¥–∞—Å—Ç –≤–∞–º –º—è–≥–∫—É—é –∏ —Ç–æ—á–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å.
        </p>
      </div>

      <div
        class="bg-slate-900 bg-opacity-70 rounded-xl shadow-md p-6 backdrop-blur"
      >
        <h2 class="text-2xl font-bold mb-4">üß† –î–Ω–µ–≤–Ω–∏–∫ —á—É–≤—Å—Ç–≤ –∏ –º—ã—Å–ª–µ–π</h2>

        <div
          id="saveSuccess"
          class="hidden mb-4 p-2 bg-green-600 text-white text-sm text-center rounded fade-in"
        >
          ‚úÖ –ó–∞–ø–∏—Å—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
        </div>
        <div
          id="copySuccess"
          class="hidden mb-4 p-2 bg-blue-600 text-white text-sm text-center rounded fade-in"
        >
          üìã –°–æ–±—ã—Ç–∏–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ
        </div>

        <label class="block mb-2 font-semibold">–°–∏—Ç—É–∞—Ü–∏—è</label>
        <textarea
          id="situation"
          class="w-full p-2 bg-slate-800 text-white border border-slate-600 rounded mb-4"
          placeholder="–ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ?"
        ></textarea>

        <label class="block mb-2 font-semibold">–ú—ã—Å–ª–∏</label>
        <textarea
          id="thoughts"
          class="w-full p-2 bg-slate-800 text-white border border-slate-600 rounded mb-4"
          placeholder="–ö–∞–∫–∏–µ –º—ã—Å–ª–∏ –±—ã–ª–∏?"
        ></textarea>

        <label class="block mb-2 font-semibold">–ß—É–≤—Å—Ç–≤–∞</label>
        <div id="feelings" class="mb-4 flex flex-wrap gap-2">
          <!-- –ß—É–≤—Å—Ç–≤–∞ –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
        </div>
        <input
          id="customFeeling"
          type="text"
          class="w-full p-2 bg-slate-800 text-white border border-slate-600 rounded mb-4"
          placeholder="–ò–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ —Å–≤–æ—ë —á—É–≤—Å—Ç–≤–æ"
        />

        <label class="block mb-2 font-semibold"
          >–ò—Ç–æ–≥ / –ü–æ–≤–µ–¥–µ–Ω–∏–µ / –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è</label
        >
        <textarea
          id="outcome"
          class="w-full p-2 bg-slate-800 text-white border border-slate-600 rounded mb-4"
          placeholder="–ß—Ç–æ –≤—ã —Å–¥–µ–ª–∞–ª–∏ –∏ –∫–∞–∫–∏–µ –≤—ã–≤–æ–¥—ã?"
        ></textarea>

        <div class="flex justify-between">
          <button
            id="saveBtn"
            class="bg-blue-600 hover:bg-blue-500 text-white py-2 px-4 rounded"
          >
            –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å
          </button>
        </div>

        <div id="entries" class="mt-6">
          <h3 class="text-xl font-semibold mb-2">–°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏:</h3>
          <ul id="entriesList" class="space-y-2"></ul>
        </div>
      </div>
    </div>

    <script>
      const feelingsList = [
        "—Ç—Ä–µ–≤–æ–≥–∞",
        "—Å—Ç—Ä–∞—Ö",
        "–≤–∏–Ω–∞",
        "–≥—Ä—É—Å—Ç—å",
        "–∑–ª–æ—Å—Ç—å",
        "–æ–±–∏–¥–∞",
        "—Ä–∞–¥–æ—Å—Ç—å",
        "–±–µ—Å–ø–æ–º–æ—â–Ω–æ—Å—Ç—å",
        "–æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–æ",
        "—É—Å—Ç–∞–ª–æ—Å—Ç—å",
        "–Ω–∞–¥–µ–∂–¥–∞",
        "—Ä–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω–∏–µ",
      ];
      const feelingsContainer = document.getElementById("feelings");

      feelingsList.forEach((feeling) => {
        const feelingTag = document.createElement("div");
        feelingTag.className =
          "cursor-pointer border border-slate-600 text-white px-3 py-1 rounded-full hover:bg-slate-700 select-none";
        feelingTag.innerText = feeling;

        // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ click –∏ touchstart (–º–æ–±–∞–π–ª UX)
        const toggleFeeling = () => feelingTag.classList.toggle("bg-slate-500");
        feelingTag.addEventListener("click", toggleFeeling);
        feelingTag.addEventListener("touchstart", toggleFeeling);

        feelingsContainer.appendChild(feelingTag);
      });

      const entriesList = document.getElementById("entriesList");
      const successBox = document.getElementById("saveSuccess");
      const copyBox = document.getElementById("copySuccess");

      function showIndicator(element) {
        element.classList.remove("hidden");
        element.classList.add("fade-in");
        setTimeout(() => {
          element.classList.add("hidden");
          element.classList.remove("fade-in");
        }, 2000);
      }

      function renderEntries() {
        const entries = JSON.parse(
          localStorage.getItem("diaryEntries") || "[]"
        );
        entriesList.innerHTML = "";
        entries.forEach((entry, index) => {
          const li = document.createElement("li");
          li.className =
            "p-2 bg-slate-800 text-white rounded shadow-sm flex justify-between items-center";
          li.innerHTML = `
          <span>${entry.situation.substring(0, 30)}...</span>
          <button class="text-sm text-blue-400 hover:underline" onclick='copyEntry(${index})'>–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ</button>
        `;
          entriesList.appendChild(li);
        });
      }

      function copyEntry(index) {
        const entries = JSON.parse(
          localStorage.getItem("diaryEntries") || "[]"
        );
        const entry = entries[index];
        const formattedText =
          `–°–∏—Ç—É–∞—Ü–∏—è:\n${entry.situation}\n\n` +
          `–ú—ã—Å–ª–∏:\n${entry.thoughts}\n\n` +
          `–ß—É–≤—Å—Ç–≤–∞:\n${entry.feelings.join(", ")}\n\n` +
          `–ò—Ç–æ–≥:\n${entry.outcome}`;

        navigator.clipboard.writeText(formattedText).then(() => {
          showIndicator(copyBox);
        });
      }

      document.getElementById("saveBtn").addEventListener("click", () => {
        const selectedFeelings = Array.from(feelingsContainer.children)
          .filter((el) => el.classList.contains("bg-slate-500"))
          .map((el) => el.innerText);

        const customFeeling = document.getElementById("customFeeling").value;
        if (customFeeling) selectedFeelings.push(customFeeling);

        const entry = {
          situation: document.getElementById("situation").value,
          thoughts: document.getElementById("thoughts").value,
          feelings: selectedFeelings,
          outcome: document.getElementById("outcome").value,
        };

        const entries = JSON.parse(
          localStorage.getItem("diaryEntries") || "[]"
        );
        entries.push(entry);
        localStorage.setItem("diaryEntries", JSON.stringify(entries));

        renderEntries();

        // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª–µ–π –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        document.getElementById("situation").value = "";
        document.getElementById("thoughts").value = "";
        document.getElementById("outcome").value = "";
        document.getElementById("customFeeling").value = "";
        Array.from(feelingsContainer.children).forEach((el) =>
          el.classList.remove("bg-slate-500")
        );

        showIndicator(successBox);
      });

      renderEntries();
    </script>
  </body>
</html>
